# Amazon Athena User Guide

-----
*****Copyright &copy; Amazon Web Services, Inc. and/or its affiliates. All rights reserved.*****

-----
Amazon's trademarks and trade dress may not be used in 
     connection with any product or service that is not Amazon's, 
     in any manner that is likely to cause confusion among customers, 
     or in any manner that disparages or discredits Amazon. All other 
     trademarks not owned by Amazon are the property of their respective
     owners, who may or may not be affiliated with, connected to, or 
     sponsored by Amazon.

-----
## Contents
+ [What is Amazon Athena?](what-is.md)
   + [When should I use Athena?](when-should-i-use-ate.md)
   + [AWS service integrations with Athena](athena-aws-service-integrations.md)
   + [Setting up](setting-up.md)
   + [Accessing Athena](accessing-athena.md)
+ [Using Athena SQL](using-athena-sql.md)
   + [Understanding tables, databases, and the Data Catalog](understanding-tables-databases-and-the-data-catalog.md)
   + [Getting started](getting-started.md)
   + [Connecting to data sources](work-with-data-stores.md)
      + [Integration with AWS Glue](glue-athena.md)
         + [Using AWS Glue to connect to data sources in Amazon S3](data-sources-glue.md)
         + [Registering an AWS Glue Data Catalog from another account](data-sources-glue-cross-account.md)
         + [Best practices when using Athena with AWS Glue](glue-best-practices.md)
         + [Upgrading to the AWS Glue Data Catalog step-by-step](glue-upgrade.md)
         + [FAQ: Upgrading to the AWS Glue Data Catalog](glue-faq.md)
      + [Using Athena Data Connector for External Hive Metastore](connect-to-data-source-hive.md)
         + [Connecting Athena to an Apache Hive metastore](connect-to-data-source-hive-connecting-athena-to-an-apache-hive-metastore.md)
         + [Using the AWS Serverless Application Repository to deploy a Hive data source connector](connect-data-source-sar-hive.md)
         + [Connecting Athena to a Hive metastore using an existing IAM execution role](connect-data-source-hive-existing-iam-role.md)
         + [Configure Athena to use a deployed Hive metastore connector](connect-data-source-hive-existing-lambda.md)
         + [Using a default data source name in external Hive metastore queries](datastores-hive-default-catalog.md)
         + [Working with Hive views](hive-views.md)
         + [Using the AWS CLI with Hive metastores](datastores-hive-cli.md)
         + [Reference implementation](datastores-hive-reference-implementation.md)
      + [Using Amazon Athena Federated Query](connect-to-a-data-source.md)
         + [Deploying a connector and connecting to a data source](connect-to-a-data-source-lambda.md)
         + [Using the AWS Serverless Application Repository to deploy a data source connector](connect-data-source-serverless-app-repo.md)
         + [Creating a VPC for a data source connector](athena-connectors-vpc-creation.md)
         + [Using Athena data source connectors](connectors-prebuilt.md)
            + [Amazon Athena Azure Data Lake Storage (ADLS) Gen2 connector](connectors-adls-gen2.md)
            + [Amazon Athena Azure Synapse connector](connectors-azure-synapse.md)
            + [Amazon Athena Google BigQuery connector](connectors-bigquery.md)
            + [Amazon Athena Cloudera Hive connector](connectors-cloudera-hive.md)
            + [Amazon Athena Cloudera Impala connector](connectors-cloudera-impala.md)
            + [Amazon Athena CloudWatch connector](connectors-cloudwatch.md)
            + [Amazon Athena CloudWatch Metrics connector](connectors-cwmetrics.md)
            + [Amazon Athena AWS CMDB connector](connectors-cmdb.md)
            + [Amazon Athena IBM Db2 connector](connectors-ibm-db2.md)
            + [Amazon Athena DocumentDB connector](connectors-docdb.md)
            + [Amazon Athena DynamoDB connector](connectors-dynamodb.md)
            + [Amazon Athena HBase connector](connectors-hbase.md)
            + [Amazon Athena Hortonworks connector](connectors-hortonworks.md)
            + [Amazon Athena MSK Connector](connectors-msk.md)
            + [Amazon Athena MySQL connector](connectors-mysql.md)
            + [Amazon Athena Neptune connector](connectors-neptune.md)
            + [Amazon Athena OpenSearch connector](connectors-opensearch.md)
            + [Amazon Athena Oracle connector](connectors-oracle.md)
            + [Amazon Athena PostgreSQL connector](connectors-postgresql.md)
            + [Amazon Athena Redis connector](connectors-redis.md)
            + [Amazon Athena Redshift connector](connectors-redshift.md)
            + [Amazon Athena SAP HANA connector](connectors-sap-hana.md)
            + [Amazon Athena Snowflake connector](connectors-snowflake.md)
            + [Amazon Athena Microsoft SQL Server connector](connectors-microsoft-sql-server.md)
            + [Amazon Athena Teradata connector](connectors-teradata.md)
            + [Amazon Athena Timestream connector](connectors-timestream.md)
            + [Amazon Athena TPC benchmark DS (TPC-DS) connector](connectors-tpcds.md)
            + [Amazon Athena Vertica connector](connectors-vertica.md)
         + [Writing federated queries](writing-federated-queries.md)
         + [Enabling cross-account federated queries](xacct-fed-query-enable.md)
         + [Writing a data source connector using the Athena Query Federation SDK](connect-data-source-federation-sdk.md)
      + [IAM policies for accessing data catalogs](datacatalogs-iam-policy.md)
         + [Data Catalog example policies](datacatalogs-example-policies.md)
      + [Managing data sources](data-sources-managing.md)
      + [Connecting to Amazon Athena with ODBC and JDBC drivers](athena-bi-tools-jdbc-odbc.md)
         + [Using Athena with the JDBC driver](connect-with-jdbc.md)
         + [Connecting to Amazon Athena with ODBC](connect-with-odbc.md)
         + [Configuring federated access to Amazon Athena for Microsoft AD FS users using an ODBC client](odbc-adfs-saml.md)
         + [Configuring SSO for ODBC using the Okta plugin and Okta Identity Provider](odbc-okta-plugin.md)
         + [Configuring single sign-on using ODBC, SAML 2.0, and the Okta Identity Provider](okta-saml-sso.md)
         + [Configuring SSO for Azure AD Single-Account Access using ODBC](odbc-azure-saml-sso.md)
         + [Using the Amazon Athena Power BI connector](connect-with-odbc-and-power-bi.md)
   + [Creating databases and tables](work-with-data.md)
      + [Creating databases in Athena](creating-databases.md)
      + [Creating tables in Athena](creating-tables.md)
      + [Names for tables, databases, and columns](tables-databases-columns-names.md)
      + [Reserved keywords](reserved-words.md)
      + [Table location in Amazon S3](tables-location-format.md)
      + [Columnar storage formats](columnar-storage.md)
      + [Converting to columnar formats](convert-to-columnar.md)
      + [Partitioning data in Athena](partitions.md)
      + [Partition projection with Amazon Athena](partition-projection.md)
         + [Setting up partition projection](partition-projection-setting-up.md)
         + [Supported types for partition projection](partition-projection-supported-types.md)
         + [Dynamic ID partitioning](partition-projection-dynamic-id-partitioning.md)
         + [Amazon Kinesis Data Firehose example](partition-projection-kinesis-firehose-example.md)
   + [Creating a table from query results (CTAS)](ctas.md)
      + [Considerations and limitations for CTAS queries](considerations-ctas.md)
      + [Running CTAS queries in the console](ctas-console.md)
      + [Bucketing vs partitioning](bucketing-vs-partitioning.md)
      + [Examples of CTAS queries](ctas-examples.md)
      + [Using CTAS and INSERT INTO for ETL and data analysis](ctas-insert-into-etl.md)
      + [Using CTAS and INSERT INTO to create a table with more than 100 partitions](ctas-insert-into.md)
   + [Athena compression support](compression-formats.md)
   + [SerDe reference](serde-reference.md)
      + [Using a SerDe](serde-about.md)
      + [Supported SerDes and data formats](supported-serdes.md)
         + [Amazon Ion Hive SerDe](ion-serde.md)
            + [Using CREATE TABLE to create Amazon Ion tables](ion-serde-using-create-table.md)
            + [Using CTAS and INSERT INTO to create Amazon Ion tables](ion-serde-using-ctas-and-insert-into-to-create-ion-tables.md)
            + [Using Amazon Ion SerDe properties](ion-serde-using-ion-serde-properties.md)
            + [Using path extractors](ion-serde-using-path-extractors.md)
         + [Avro SerDe](avro-serde.md)
         + [Grok SerDe](grok-serde.md)
         + [JSON SerDe libraries](json-serde.md)
            + [Hive JSON SerDe](hive-json-serde.md)
            + [OpenX JSON SerDe](openx-json-serde.md)
         + [LazySimpleSerDe for CSV, TSV, and custom-delimited files](lazy-simple-serde.md)
         + [OpenCSVSerDe for processing CSV](csv-serde.md)
         + [ORC SerDe](orc-serde.md)
         + [Parquet SerDe](parquet-serde.md)
         + [Regex SerDe](regex-serde.md)
   + [Running SQL queries using Amazon Athena](querying-athena-tables.md)
      + [Viewing execution plans for SQL queries](query-plans.md)
      + [Working with query results, recent queries, and output files](querying.md)
      + [Reusing query results](reusing-query-results.md)
      + [Viewing statistics and execution details for completed queries](query-stats.md)
      + [Working with views](views.md)
      + [Using saved queries](saved-queries.md)
      + [Using parameterized queries](querying-with-prepared-statements.md)
      + [Handling schema updates](handling-schema-updates-chapter.md)
         + [Types of updates](types-of-updates.md)
         + [Updates in tables with partitions](updates-and-partitions.md)
      + [Querying arrays](querying-arrays.md)
         + [Creating arrays](creating-arrays.md)
         + [Concatenating strings and arrays](concatenating-strings-and-arrays.md)
         + [Converting array data types](converting-array-data-types.md)
         + [Finding lengths](finding-lengths.md)
         + [Accessing array elements](accessing-array-elements.md)
         + [Flattening nested arrays](flattening-arrays.md)
         + [Creating arrays from subqueries](creating-arrays-from-subqueries.md)
         + [Filtering arrays](filtering-arrays.md)
         + [Sorting arrays](sorting-arrays.md)
         + [Using aggregation functions with arrays](arrays-and-aggregation.md)
         + [Converting arrays to strings](converting-arrays-to-strings.md)
         + [Using arrays to create maps](maps.md)
         + [Querying arrays with complex types and nested structures](rows-and-structs.md)
      + [Querying Delta Lake tables](delta-lake-tables.md)
      + [Querying geospatial data](querying-geospatial-data.md)
         + [What is a geospatial query?](geospatial-query-what-is.md)
         + [Input data formats and geometry data types](geospatial-input-data-formats-supported-geometry-types.md)
         + [Supported geospatial functions](geospatial-functions-list.md)
            + [Geospatial functions in Athena engine version 3](geospatial-functions-v3.md)
            + [Geospatial functions in Athena engine version 2](geospatial-functions-list-v2.md)
               + [Geospatial function name changes and new functions in Athena engine version 2](geospatial-functions-list-v2-function-name-changes-and-new-functions.md)
         + [Examples: Geospatial queries](geospatial-example-queries.md)
      + [Using Athena to query Apache Hudi datasets](querying-hudi.md)
      + [Querying JSON](querying-JSON.md)
         + [Best practices for reading JSON data](parsing-JSON.md)
         + [Extracting data from JSON](extracting-data-from-JSON.md)
         + [Searching for values in JSON arrays](searching-for-values.md)
         + [Obtaining length and size of JSON arrays](length-and-size.md)
         + [Troubleshooting JSON queries](json-troubleshooting.md)
      + [Using Machine Learning (ML) with Amazon Athena](querying-mlmodel.md)
      + [Querying with user defined functions](querying-udf.md)
      + [Querying across regions](querying-across-regions.md)
      + [Querying AWS Glue Data Catalog](querying-glue-catalog.md)
      + [Querying AWS service logs](querying-aws-service-logs.md)
         + [Querying Application Load Balancer logs](application-load-balancer-logs.md)
         + [Querying Classic Load Balancer logs](elasticloadbalancer-classic-logs.md)
         + [Querying Amazon CloudFront logs](cloudfront-logs.md)
         + [Querying AWS CloudTrail logs](cloudtrail-logs.md)
         + [Querying Amazon EMR logs](emr-logs.md)
         + [Querying AWS Global Accelerator flow logs](querying-global-accelerator-flow-logs.md)
         + [Querying Amazon GuardDuty findings](querying-guardduty.md)
         + [Querying AWS Network Firewall logs](querying-network-firewall-logs.md)
         + [Querying Network Load Balancer logs](networkloadbalancer-classic-logs.md)
         + [Querying Amazon Route 53 resolver query logs](querying-r53-resolver-logs.md)
         + [Querying Amazon SES event logs](querying-ses-logs.md)
         + [Querying Amazon VPC flow logs](vpc-flow-logs.md)
         + [Querying AWS WAF logs](waf-logs.md)
      + [Querying web server logs stored in Amazon S3](querying-web-server-logs.md)
         + [Querying Apache logs stored in Amazon S3](querying-apache-logs.md)
         + [Querying internet information server (IIS) logs stored in Amazon S3](querying-iis-logs.md)
   + [Using Athena ACID transactions](acid-transactions.md)
      + [Using governed tables](lf-governed-tables.md)
         + [Creating governed tables](lf-governed-tables-creating.md)
         + [Querying governed tables](lf-governed-tables-querying.md)
         + [Supported data types](lf-governed-tables-supported-data-types.md)
      + [Using Iceberg tables](querying-iceberg.md)
         + [Creating Iceberg tables](querying-iceberg-creating-tables.md)
         + [Managing Iceberg tables](querying-iceberg-managing-tables.md)
         + [Evolving Iceberg table schema](querying-iceberg-evolving-table-schema.md)
         + [Querying Iceberg table data and performing time travel](querying-iceberg-table-data.md)
         + [Updating Iceberg table data](querying-iceberg-updating-iceberg-table-data.md)
         + [Optimizing Iceberg tables](querying-iceberg-data-optimization.md)
         + [Supported data types](querying-iceberg-supported-data-types.md)
         + [Other Athena operations on Iceberg tables](querying-iceberg-additional-operations.md)
   + [Amazon Athena security](security.md)
      + [Data protection in Athena](security-data-protection.md)
         + [Encryption at rest](encryption.md)
            + [Encrypting Athena query results stored in Amazon S3](encrypting-query-results-stored-in-s3.md)
            + [Creating tables based on encrypted datasets in Amazon S3](creating-tables-based-on-encrypted-datasets-in-s3.md)
         + [Encryption in transit](encryption-in-transit.md)
         + [Key management](key-management.md)
         + [Internetwork traffic privacy](internetwork-traffic-privacy.md)
      + [Identity and access management in Athena](security-iam-athena.md)
         + [AWS managed policies for Amazon Athena](managed-policies.md)
         + [Access through JDBC and ODBC connections](policy-actions.md)
         + [Access to Amazon S3](s3-permissions.md)
         + [Cross-account access in Athena to Amazon S3 buckets](cross-account-permissions.md)
         + [Fine-grained access to databases and tables in the AWS Glue Data Catalog](fine-grained-access-to-glue-resources.md)
         + [Cross-account access to AWS Glue data catalogs](security-iam-cross-account-glue-catalog-access.md)
         + [Access from Athena to encrypted metadata in the AWS Glue Data Catalog](access-encrypted-data-glue-data-catalog.md)
         + [Access to workgroups and tags](workgroups-access.md)
         + [Allow access to prepared statements](security-iam-athena-prepared-statements.md)
         + [Using Athena with CalledVia context keys](security-iam-athena-calledvia.md)
         + [Allow access to an Athena Data Connector for External Hive Metastore](hive-metastore-iam-access.md)
         + [Allow Lambda function access to external Hive metastores](hive-metastore-iam-access-lambda.md)
         + [Example IAM permissions policies to allow Athena Federated Query](federated-query-iam-access.md)
         + [Example IAM permissions policies to allow Amazon Athena User Defined Functions (UDF)](udf-iam-access.md)
         + [Allowing access for ML with Athena](machine-learning-iam-access.md)
         + [Enabling federated access to the Athena API](access-federation-saml.md)
      + [Logging and monitoring in Athena](security-logging-monitoring.md)
         + [Logging Amazon Athena API calls with AWS CloudTrail](monitor-with-cloudtrail.md)
      + [Compliance validation for Amazon Athena](security-compliance-validation.md)
      + [Resilience in Athena](security-resilience.md)
      + [Infrastructure security in Athena](security-infrastructure.md)
         + [Connect to Amazon Athena using an interface VPC endpoint](interface-vpc-endpoint.md)
      + [Configuration and vulnerability analysis in Athena](security-vulnerability-management.md)
      + [Using Athena to query data registered with AWS Lake Formation](security-athena-lake-formation.md)
         + [How Athena accesses data registered with Lake Formation](lf-athena-access.md)
         + [Considerations and limitations when using Athena to query data registered with Lake Formation](lf-athena-limitations.md)
         + [Managing Lake Formation and Athena user permissions](lf-athena-user-permissions.md)
         + [Applying Lake Formation permissions to existing databases and tables](lf-athena-removing-permissions.md)
         + [Using Lake Formation and the Athena JDBC and ODBC drivers for federated access to Athena](security-athena-lake-formation-jdbc.md)
            + [Tutorial: Configuring federated access for Okta users to Athena using Lake Formation and JDBC](security-athena-lake-formation-jdbc-okta-tutorial.md)
   + [Using workgroups to control query access and costs](manage-queries-control-costs-with-workgroups.md)
      + [Using workgroups for running queries](workgroups.md)
         + [Benefits of using workgroups](workgroups-benefits.md)
         + [How workgroups work](user-created-workgroups.md)
         + [Setting up workgroups](workgroups-procedure.md)
         + [IAM policies for accessing workgroups](workgroups-iam-policy.md)
            + [Workgroup example policies](example-policies-workgroup.md)
         + [Workgroup settings](workgroups-settings.md)
            + [Workgroup settings override client-side settings](workgroups-settings-override.md)
         + [Managing workgroups](workgroups-create-update-delete.md)
         + [Athena workgroup APIs](workgroups-api-list.md)
         + [Troubleshooting workgroups](workgroups-troubleshooting.md)
      + [Controlling costs and monitoring queries with CloudWatch metrics and events](control-limits.md)
         + [Enabling CloudWatch query metrics](athena-cloudwatch-metrics-enable.md)
         + [Monitoring Athena queries with CloudWatch metrics](query-metrics-viewing.md)
         + [Monitoring Athena queries with CloudWatch events](athena-cloudwatch-events.md)
         + [Monitoring Athena usage metrics](monitoring-athena-usage-metrics.md)
         + [Setting data usage control limits](workgroups-setting-control-limits-cloudwatch.md)
   + [Tagging Athena resources](tags.md)
      + [Working with tags on workgroups in the console](tags-console.md)
      + [Using tag operations](tags-operations.md)
      + [Tag-based IAM access control policies](tags-access-control.md)
   + [Athena engine versioning](engine-versions.md)
      + [Changing Athena engine versions](engine-versions-changing.md)
      + [Athena engine version reference](engine-versions-reference.md)
         + [Athena engine version 3](engine-versions-reference-0003.md)
         + [Athena engine version 2](engine-versions-reference-0002.md)
   + [SQL reference for Athena](ddl-sql-reference.md)
      + [Data types in Amazon Athena](data-types.md)
      + [DML queries, functions, and operators](dml-queries-functions-operators.md)
         + [SELECT](select.md)
         + [INSERT INTO](insert-into.md)
         + [DELETE](delete-statement.md)
         + [UPDATE](update-statement.md)
         + [MERGE INTO](merge-into-statement.md)
         + [OPTIMIZE](optimize-statement.md)
         + [VACUUM](vacuum-statement.md)
         + [Using EXPLAIN and EXPLAIN ANALYZE in Athena](athena-explain-statement.md)
            + [Understanding Athena EXPLAIN statement results](athena-explain-statement-understanding.md)
         + [PREPARE](sql-prepare.md)
            + [EXECUTE](sql-execute.md)
            + [DEALLOCATE PREPARE](sql-deallocate-prepare.md)
         + [UNLOAD](unload.md)
         + [Functions in Amazon Athena](functions.md)
         + [Supported time zones](athena-supported-time-zones.md)
      + [DDL statements](ddl-reference.md)
         + [Unsupported DDL](unsupported-ddl.md)
         + [ALTER DATABASE SET DBPROPERTIES](alter-database-set-dbproperties.md)
         + [ALTER TABLE ADD COLUMNS](alter-table-add-columns.md)
         + [ALTER TABLE ADD PARTITION](alter-table-add-partition.md)
         + [ALTER TABLE DROP PARTITION](alter-table-drop-partition.md)
         + [ALTER TABLE RENAME PARTITION](alter-table-rename-partition.md)
         + [ALTER TABLE REPLACE COLUMNS](alter-table-replace-columns.md)
         + [ALTER TABLE SET LOCATION](alter-table-set-location.md)
         + [ALTER TABLE SET TBLPROPERTIES](alter-table-set-tblproperties.md)
         + [CREATE DATABASE](create-database.md)
         + [CREATE TABLE](create-table.md)
         + [CREATE TABLE AS](create-table-as.md)
         + [CREATE VIEW](create-view.md)
         + [DESCRIBE](describe-table.md)
         + [DESCRIBE VIEW](describe-view.md)
         + [DROP DATABASE](drop-database.md)
         + [DROP TABLE](drop-table.md)
         + [DROP VIEW](drop-view.md)
         + [MSCK REPAIR TABLE](msck-repair-table.md)
         + [SHOW COLUMNS](show-columns.md)
         + [SHOW CREATE TABLE](show-create-table.md)
         + [SHOW CREATE VIEW](show-create-view.md)
         + [SHOW DATABASES](show-databases.md)
         + [SHOW PARTITIONS](show-partitions.md)
         + [SHOW TABLES](show-tables.md)
         + [SHOW TBLPROPERTIES](show-tblproperties.md)
         + [SHOW VIEWS](show-views.md)
      + [Considerations and limitations for SQL queries in Amazon Athena](other-notable-limitations.md)
   + [Troubleshooting in Athena](troubleshooting-athena.md)
      + [Athena error catalog](error-reference.md)
   + [Performance tuning in Athena](performance-tuning.md)
   + [Service Quotas](service-limits.md)
   + [Code samples](code-samples.md)
+ [Using Apache Spark in Amazon Athena](notebooks-spark.md)
   + [Getting started with Apache Spark on Amazon Athena](notebooks-spark-getting-started.md)
   + [Working with notebooks](notebooks-spark-working-with-notebooks.md)
      + [Using the Athena notebook editor](notebooks-spark-editor.md)
      + [Managing notebook files](notebooks-spark-managing.md)
   + [Python library support in Amazon Athena for Apache Spark](notebooks-spark-python-library-support.md)
      + [List of preinstalled Python libraries](notebooks-spark-preinstalled-python-libraries.md)
      + [Importing files and Python libraries to Amazon Athena for Apache Spark](notebooks-import-files-libraries.md)
   + [Adding JAR files to Athena for Apache Spark](notebooks-spark-adding-jar-files.md)
   + [Supported data and storage formats](notebooks-spark-data-and-storage-formats.md)
   + [Monitoring Apache Spark calculations with CloudWatch metrics](notebooks-spark-metrics.md)
   + [Athena notebook APIs](notebooks-spark-api-list.md)
   + [Known issues in Athena for Spark](notebooks-spark-known-issues.md)
   + [Troubleshooting Athena for Spark](notebooks-spark-troubleshooting.md)
      + [Troubleshooting Spark-enabled workgroups](notebooks-spark-troubleshooting-workgroups.md)
      + [Using the Spark EXPLAIN statement to troubleshoot Spark SQL](notebooks-spark-troubleshooting-explain.md)
      + [Logging Spark application events in Athena](notebooks-spark-logging.md)
      + [Using CloudTrail to troubleshoot Athena notebook API calls](notebooks-spark-troubleshooting-cloudtrail.md)
      + [Troubleshooting sessions](notebooks-spark-troubleshooting-sessions.md)
      + [Troubleshooting tables](notebooks-spark-troubleshooting-tables.md)
      + [Getting support](notebooks-spark-troubleshooting-support.md)
+ [Release notes](release-notes.md)
+ [Document history](DocHistory.md)
+ [AWS glossary](glossary.md)